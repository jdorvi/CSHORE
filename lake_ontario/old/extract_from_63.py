# -*- coding: utf-8 - Python 2.7.11 *-
"""
Description: Reads Adcirc Global Output file fort.63 & returns time series at
selected nodes. 
Input(s): fort.63, Nodes of interest
Output(s): Time series .txt files 
jdorvinen@dewberry.com, slawler@dewberry.com
Created on Tue Apr 19 15:08:33 2016 
"""
#------------Load Python Modules--------------------#
import fileinput
from datetime import datetime as dt

#------------User Inputs----------------------------#
infile = 'fort.63'
''''---Enter Nodes of Interest in the nodes dictionary---'''
nodes = {"23102":["Transect_123\n"],"23286":["Transect_124\n"],"23383":["Transect_125\n"],"23381":["Transect_126\n"],"23675":["Transect_127\n"],"23765":["Transect_128\n"],"24208":["Transect_129\n"],"24593":["Transect_130\n"],"25336":["Transect_131\n"],"25335":["Transect_132\n"],"24823":["Transect_133\n"],"26710":["Transect_134\n"],"26169":["Transect_135\n"],"27445":["Transect_136\n"],"28109":["Transect_137\n"],"27202":["Transect_138\n"],"30218":["Transect_139\n"],"30541":["Transect_140\n"],"28940":["Transect_141\n"],"29588":["Transect_142\n"],"29247":["Transect_143\n"],"30848":["Transect_144\n"],"30498":["Transect_145\n"],"30175":["Transect_146\n"],"29863":["Transect_147\n"],"32310":["Transect_148\n"],"33843":["Transect_149\n"],"35778":["Transect_150\n"],"36884":["Transect_151\n"],"38175":["Transect_152\n"],"40381":["Transect_153\n"],"42628":["Transect_154\n"],"47508":["Transect_155\n"],"51576":["Transect_156\n"],"53392":["Transect_157\n"],"57093":["Transect_158\n"],"58648":["Transect_159\n"],"59231":["Transect_160\n"],"62174":["Transect_161\n"],"64925":["Transect_162\n"],"64923":["Transect_163\n"],"61564":["Transect_164\n"],"62156":["Transect_165\n"],"62150":["Transect_166\n"],"60377":["Transect_167\n"],"59809":["Transect_168\n"],"59801":["Transect_169\n"],"60943":["Transect_170\n"],"57075":["Transect_171\n"],"55043":["Transect_172\n"],"55040":["Transect_173\n"],"54226":["Transect_174\n"],"57061":["Transect_175\n"],"58614":["Transect_176\n"],"60346":["Transect_177\n"],"58607":["Transect_178\n"],"55019":["Transect_179\n"],"53361":["Transect_180\n"],"49856":["Transect_181\n"],"46071":["Transect_182\n"],"49850":["Transect_183\n"],"53358":["Transect_184\n"],"55013":["Transect_185\n"],"55822":["Transect_186\n"],"56464":["Transect_187\n"],"55819":["Transect_188\n"],"54200":["Transect_189\n"],"52461":["Transect_190\n"],"50670":["Transect_191\n"],"49839":["Transect_192\n"],"47480":["Transect_193\n"],"46763":["Transect_194\n"],"44642":["Transect_195\n"],"43950":["Transect_196\n"],"41423":["Transect_197\n"],"40373":["Transect_198\n"],"39882":["Transect_199\n"],"38550":["Transect_200\n"],"37815":["Transect_201\n"],"37485":["Transect_202\n"],"37805":["Transect_203\n"],"37802":["Transect_204\n"],"38533":["Transect_205\n"],"39390":["Transect_206\n"],"38151":["Transect_207\n"],"37471":["Transect_208\n"],"38915":["Transect_209\n"],"40357":["Transect_210\n"],"40874":["Transect_211\n"],"42606":["Transect_212\n"],"44637":["Transect_213\n"],"45349":["Transect_214\n"],"47472":["Transect_215\n"],"48228":["Transect_216\n"],"51527":["Transect_217\n"],"55811":["Transect_218\n"],"56452":["Transect_219\n"],"55807":["Transect_220\n"],"56443":["Transect_221\n"],"57018":["Transect_222\n"],"57015":["Transect_223\n"],"54181":["Transect_224\n"],"50654":["Transect_225\n"],"48223":["Transect_226\n"],"46753":["Transect_227\n"],"44632":["Transect_228\n"],"43264":["Transect_229\n"],"41975":["Transect_230\n"],"41975":["Transect_231\n"],"40352":["Transect_232\n"],"39365":["Transect_233\n"],"38514":["Transect_234\n"],"40339":["Transect_235\n"],"41389":["Transect_236\n"],"42581":["Transect_237\n"],"41383":["Transect_238\n"],"43234":["Transect_239\n"],"41955":["Transect_240\n"],"45321":["Transect_241\n"],"45319":["Transect_242\n"],"44606":["Transect_243\n"],"43900":["Transect_244\n"],"43225":["Transect_245\n"],"42564":["Transect_246\n"],"42561":["Transect_247\n"],"41367":["Transect_248\n"],"41365":["Transect_249\n"],"41362":["Transect_250\n"],"41360":["Transect_251\n"],"41358":["Transect_252\n"],"41923":["Transect_253\n"],"41922":["Transect_254\n"],"42536":["Transect_255\n"],"42534":["Transect_256\n"],"42532":["Transect_257\n"],"43213":["Transect_258\n"],"44595":["Transect_259\n"],"49000":["Transect_260\n"],"44591":["Transect_261\n"],"44588":["Transect_262\n"],"45999":["Transect_263\n"],"44583":["Transect_264\n"],"41346":["Transect_265\n"],"39813":["Transect_266\n"],"38876":["Transect_267\n"],"37137":["Transect_268\n"],"35748":["Transect_269\n"],"35466":["Transect_270\n"],"35191":["Transect_271\n"],"34635":["Transect_272\n"],"34629":["Transect_273\n"],"31526":["Transect_274\n"],"28599":["Transect_275\n"],"28885":["Transect_276\n"],"30779":["Transect_277\n"],"33769":["Transect_278\n"],"33808":["Transect_279\n"],"34871":["Transect_280\n"],"34891":["Transect_281\n"],"36283":["Transect_282\n"],"36007":["Transect_283\n"],"37425":["Transect_284\n"],"38094":["Transect_285\n"],"39310":["Transect_286\n"],"39797":["Transect_287\n"],"43190":["Transect_288\n"],"41317":["Transect_289\n"],"40793":["Transect_290\n"],"41318":["Transect_291\n"],"41318":["Transect_292\n"],"41314":["Transect_293\n"],"40783":["Transect_294\n"],"40782":["Transect_295\n"],"40271":["Transect_296\n"],"40778":["Transect_297\n"],"41302":["Transect_298\n"],"41852":["Transect_299\n"],"43820":["Transect_300\n"],"42454":["Transect_301\n"],"42452":["Transect_302\n"],"43137":["Transect_303\n"],"108146":["Transect_304\n"],"23101":["Transect_123\n"],"23193":["Transect_124\n"],"23284":["Transect_125\n"],"23482":["Transect_126\n"],"23676":["Transect_127\n"],"23857":["Transect_128\n"],"24134":["Transect_129\n"],"24518":["Transect_130\n"],"25236":["Transect_131\n"],"25235":["Transect_132\n"],"24744":["Transect_133\n"],"26861":["Transect_134\n"],"26167":["Transect_135\n"],"27667":["Transect_136\n"],"27878":["Transect_137\n"],"27020":["Transect_138\n"],"30211":["Transect_139\n"],"30879":["Transect_140\n"],"29257":["Transect_141\n"],"29257":["Transect_142\n"],"29577":["Transect_143\n"],"30504":["Transect_144\n"],"30841":["Transect_145\n"],"30495":["Transect_146\n"],"30168":["Transect_147\n"],"32309":["Transect_148\n"],"33507":["Transect_149\n"],"35779":["Transect_150\n"],"36885":["Transect_151\n"],"38176":["Transect_152\n"],"39890":["Transect_153\n"],"41995":["Transect_154\n"],"47509":["Transect_155\n"],"52507":["Transect_156\n"],"53393":["Transect_157\n"],"56525":["Transect_158\n"],"58649":["Transect_159\n"],"59831":["Transect_160\n"],"61571":["Transect_161\n"],"64192":["Transect_162\n"],"64924":["Transect_163\n"],"61563":["Transect_164\n"],"62157":["Transect_165\n"],"62151":["Transect_166\n"],"60959":["Transect_167\n"],"59810":["Transect_168\n"],"59802":["Transect_169\n"],"60944":["Transect_170\n"],"57583":["Transect_171\n"],"55857":["Transect_172\n"],"55039":["Transect_173\n"],"55034":["Transect_174\n"],"57577":["Transect_175\n"],"58615":["Transect_176\n"],"59784":["Transect_177\n"],"58608":["Transect_178\n"],"55830":["Transect_179\n"],"52477":["Transect_180\n"],"50687":["Transect_181\n"],"46070":["Transect_182\n"],"49849":["Transect_183\n"],"52472":["Transect_184\n"],"55012":["Transect_185\n"],"56466":["Transect_186\n"],"56463":["Transect_187\n"],"55007":["Transect_188\n"],"54199":["Transect_189\n"],"53347":["Transect_190\n"],"50669":["Transect_191\n"],"49027":["Transect_192\n"],"47479":["Transect_193\n"],"46057":["Transect_194\n"],"45354":["Transect_195\n"],"43276":["Transect_196\n"],"41984":["Transect_197\n"],"40890":["Transect_198\n"],"39402":["Transect_199\n"],"38172":["Transect_200\n"],"37816":["Transect_201\n"],"37171":["Transect_202\n"],"37806":["Transect_203\n"],"37803":["Transect_204\n"],"38933":["Transect_205\n"],"38932":["Transect_206\n"],"38532":["Transect_207\n"],"37795":["Transect_208\n"],"39370":["Transect_209\n"],"39860":["Transect_210\n"],"40355":["Transect_211\n"],"41979":["Transect_212\n"],"43947":["Transect_213\n"],"46051":["Transect_214\n"],"47473":["Transect_215\n"],"49016":["Transect_216\n"],"50663":["Transect_217\n"],"54998":["Transect_218\n"],"57028":["Transect_219\n"],"56448":["Transect_220\n"],"56442":["Transect_221\n"],"57531":["Transect_222\n"],"57014":["Transect_223\n"],"54180":["Transect_224\n"],"50655":["Transect_225\n"],"47466":["Transect_226\n"],"46047":["Transect_227\n"],"45342":["Transect_228\n"],"42601":["Transect_229\n"],"41976":["Transect_230\n"],"41976":["Transect_231\n"],"40351":["Transect_232\n"],"39364":["Transect_233\n"],"38513":["Transect_234\n"],"40856":["Transect_235\n"],"40854":["Transect_236\n"],"41958":["Transect_237\n"],"41954":["Transect_238\n"],"42573":["Transect_239\n"],"42579":["Transect_240\n"],"44610":["Transect_241\n"],"44608":["Transect_242\n"],"45316":["Transect_243\n"],"44604":["Transect_244\n"],"43224":["Transect_245\n"],"43223":["Transect_246\n"],"42562":["Transect_247\n"],"40833":["Transect_248\n"],"41364":["Transect_249\n"],"41930":["Transect_250\n"],"41927":["Transect_251\n"],"41925":["Transect_252\n"],"41357":["Transect_253\n"],"41921":["Transect_254\n"],"42537":["Transect_255\n"],"41919":["Transect_256\n"],"43213":["Transect_257\n"],"43212":["Transect_258\n"],"44594":["Transect_259\n"],"49822":["Transect_260\n"],"44590":["Transect_261\n"],"45300":["Transect_262\n"],"46722":["Transect_263\n"],"44584":["Transect_264\n"],"40816":["Transect_265\n"],"40305":["Transect_266\n"],"38482":["Transect_267\n"],"37136":["Transect_268\n"],"35474":["Transect_269\n"],"35467":["Transect_270\n"],"34908":["Transect_271\n"],"34634":["Transect_272\n"],"34628":["Transect_273\n"],"31150":["Transect_274\n"],"28323":["Transect_275\n"],"28585":["Transect_276\n"],"30778":["Transect_277\n"],"34052":["Transect_278\n"],"34088":["Transect_279\n"],"34872":["Transect_280\n"],"35177":["Transect_281\n"],"36008":["Transect_282\n"],"36282":["Transect_283\n"],"37747":["Transect_284\n"],"38470":["Transect_285\n"],"39311":["Transect_286\n"],"39796":["Transect_287\n"],"42497":["Transect_288\n"],"41316":["Transect_289\n"],"40794":["Transect_290\n"],"40790":["Transect_291\n"],"40790":["Transect_292\n"],"40787":["Transect_293\n"],"40275":["Transect_294\n"],"40273":["Transect_295\n"],"40780":["Transect_296\n"],"40779":["Transect_297\n"],"40777":["Transect_298\n"],"41851":["Transect_299\n"],"43821":["Transect_300\n"],"42453":["Transect_301\n"],"43138":["Transect_302\n"],"43812":["Transect_303\n"],"107191":["Transect_304\n"],"23194":["Transect_123\n"],"23192":["Transect_124\n"],"23382":["Transect_125\n"],"23483":["Transect_126\n"],"23578":["Transect_127\n"],"23858":["Transect_128\n"],"24207":["Transect_129\n"],"24517":["Transect_130\n"],"25235":["Transect_131\n"],"25334":["Transect_132\n"],"24743":["Transect_133\n"],"26862":["Transect_134\n"],"26300":["Transect_135\n"],"27668":["Transect_136\n"],"27871":["Transect_137\n"],"27201":["Transect_138\n"],"30533":["Transect_139\n"],"30880":["Transect_140\n"],"29258":["Transect_141\n"],"29256":["Transect_142\n"],"29578":["Transect_143\n"],"30847":["Transect_144\n"],"30499":["Transect_145\n"],"30496":["Transect_146\n"],"30169":["Transect_147\n"],"32717":["Transect_148\n"],"33842":["Transect_149\n"],"35501":["Transect_150\n"],"36610":["Transect_151\n"],"37820":["Transect_152\n"],"39889":["Transect_153\n"],"42627":["Transect_154\n"],"46788":["Transect_155\n"],"51577":["Transect_156\n"],"52509":["Transect_157\n"],"56524":["Transect_158\n"],"58112":["Transect_159\n"],"59232":["Transect_160\n"],"61570":["Transect_161\n"],"64924":["Transect_162\n"],"64190":["Transect_163\n"],"62164":["Transect_164\n"],"61556":["Transect_165\n"],"61552":["Transect_166\n"],"60378":["Transect_167\n"],"59211":["Transect_168\n"],"59205":["Transect_169\n"],"60361":["Transect_170\n"],"57584":["Transect_171\n"],"55858":["Transect_172\n"],"55852":["Transect_173\n"],"55035":["Transect_174\n"],"57578":["Transect_175\n"],"58079":["Transect_176\n"],"59783":["Transect_177\n"],"58073":["Transect_178\n"],"55831":["Transect_179\n"],"52476":["Transect_180\n"],"49857":["Transect_181\n"],"46776":["Transect_182\n"],"50680":["Transect_183\n"],"52471":["Transect_184\n"],"55824":["Transect_185\n"],"55823":["Transect_186\n"],"57037":["Transect_187\n"],"55818":["Transect_188\n"],"55005":["Transect_189\n"],"52462":["Transect_190\n"],"51531":["Transect_191\n"],"49026":["Transect_192\n"],"48235":["Transect_193\n"],"46762":["Transect_194\n"],"45355":["Transect_195\n"],"43275":["Transect_196\n"],"41985":["Transect_197\n"],"40374":["Transect_198\n"],"39401":["Transect_199\n"],"38549":["Transect_200\n"],"37490":["Transect_201\n"],"37484":["Transect_202\n"],"37479":["Transect_203\n"],"37478":["Transect_204\n"],"38934":["Transect_205\n"],"39389":["Transect_206\n"],"38152":["Transect_207\n"],"37472":["Transect_208\n"],"38916":["Transect_209\n"],"40356":["Transect_210\n"],"40873":["Transect_211\n"],"42605":["Transect_212\n"],"43946":["Transect_213\n"],"45350":["Transect_214\n"],"46758":["Transect_215\n"],"49017":["Transect_216\n"],"51526":["Transect_217\n"],"55810":["Transect_218\n"],"57029":["Transect_219\n"],"56449":["Transect_220\n"],"56444":["Transect_221\n"],"57532":["Transect_222\n"],"57526":["Transect_223\n"],"54987":["Transect_224\n"],"49827":["Transect_225\n"],"48222":["Transect_226\n"],"46046":["Transect_227\n"],"45343":["Transect_228\n"],"43263":["Transect_229\n"],"41409":["Transect_230\n"],"41409":["Transect_231\n"],"40868":["Transect_232\n"],"39853":["Transect_233\n"],"38906":["Transect_234\n"],"40340":["Transect_235\n"],"40853":["Transect_236\n"],"41957":["Transect_237\n"],"41955":["Transect_238\n"],"42572":["Transect_239\n"],"41956":["Transect_240\n"],"45320":["Transect_241\n"],"45318":["Transect_242\n"],"45317":["Transect_243\n"],"43901":["Transect_244\n"],"43898":["Transect_245\n"],"43224":["Transect_246\n"],"41940":["Transect_247\n"],"41366":["Transect_248\n"],"41933":["Transect_249\n"],"41931":["Transect_250\n"],"41928":["Transect_251\n"],"41926":["Transect_252\n"],"41356":["Transect_253\n"],"42537":["Transect_254\n"],"41920":["Transect_255\n"],"41918":["Transect_256\n"],"42533":["Transect_257\n"],"43891":["Transect_258\n"],"45307":["Transect_259\n"],"49002":["Transect_260\n"],"45302":["Transect_261\n"],"44589":["Transect_262\n"],"46000":["Transect_263\n"],"43884":["Transect_264\n"],"41345":["Transect_265\n"],"40306":["Transect_266\n"],"38875":["Transect_267\n"],"37442":["Transect_268\n"],"35747":["Transect_269\n"],"35196":["Transect_270\n"],"34907":["Transect_271\n"],"34904":["Transect_272\n"],"34895":["Transect_273\n"],"31525":["Transect_274\n"],"28598":["Transect_275\n"],"28584":["Transect_276\n"],"31123":["Transect_277\n"],"33770":["Transect_278\n"],"33810":["Transect_279\n"],"34611":["Transect_280\n"],"35178":["Transect_281\n"],"36007":["Transect_282\n"],"36283":["Transect_283\n"],"37426":["Transect_284\n"],"38095":["Transect_285\n"],"38861":["Transect_286\n"],"40286":["Transect_287\n"],"42496":["Transect_288\n"],"41876":["Transect_289\n"],"40284":["Transect_290\n"],"41317":["Transect_291\n"],"41317":["Transect_292\n"],"41313":["Transect_293\n"],"40274":["Transect_294\n"],"40781":["Transect_295\n"],"40272":["Transect_296\n"],"40270":["Transect_297\n"],"40776":["Transect_298\n"],"42462":["Transect_299\n"],"43145":["Transect_300\n"],"43140":["Transect_301\n"],"43139":["Transect_302\n"],"43813":["Transect_303\n"],"108145":["Transect_304\n"]}

#------------------------------BEGIN SCRIPT----------------------------------#
a = dt.now()
print("\n Started reading Global File at \n") 
print(a)

f = fileinput.input(infile)

for line in f:
    n = line.strip().split(' ')[0] 
    if n in nodes:
        nodes[n].append(line)

for n in nodes:    
    output = open('extracted_%s.txt' %(n),'w')
    header = "      NODE                  SWEL\n"
    output.write(header)
    print('node '+n+': '+str(len(nodes[n])))
    for i in range(len(nodes[n])):
        output.write(nodes[n][i])

output.close(); fileinput.close()
    
b = dt.now()
c = b-a
print("===========END========== \n")
print("Processing Time : ")
print(c)